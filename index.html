<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文档格式转换器</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-file-import"></i> 文档格式转换器</h1>
            <p>支持各种文档格式的自由转换，保证高质量与准确性</p>
        </header>

        <main>
            <!-- 文件上传区域 -->
            <div class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <h3>拖拽文件到此处或点击选择</h3>
                    <p>支持 PDF、Word、Excel、PowerPoint、图片等格式</p>
                    <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.jpg,.jpeg,.png,.gif,.bmp">
                    <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                        <i class="fas fa-folder-open"></i> 选择文件
                    </button>
                </div>
            </div>

            <!-- 转换选项 -->
            <div class="conversion-section" id="conversionSection" style="display: none;">
                <h2>选择转换格式</h2>
                <div class="file-info">
                    <div class="file-item" id="fileItem">
                        <i class="fas fa-file"></i>
                        <span id="fileName">文件名</span>
                        <span id="fileSize">文件大小</span>
                    </div>
                </div>

                <div class="format-options">
                    <div class="format-group">
                        <h3>文档格式</h3>
                        <div class="format-buttons">
                            <button class="format-btn" data-format="pdf">
                                <i class="fas fa-file-pdf"></i> PDF
                            </button>
                            <button class="format-btn" data-format="docx">
                                <i class="fas fa-file-word"></i> Word
                            </button>
                            <button class="format-btn" data-format="txt">
                                <i class="fas fa-file-alt"></i> TXT
                            </button>
                        </div>
                    </div>

                    <div class="format-group">
                        <h3>表格格式</h3>
                        <div class="format-buttons">
                            <button class="format-btn" data-format="xlsx">
                                <i class="fas fa-file-excel"></i> Excel
                            </button>
                            <button class="format-btn" data-format="csv">
                                <i class="fas fa-file-csv"></i> CSV
                            </button>
                        </div>
                    </div>

                    <div class="format-group">
                        <h3>演示格式</h3>
                        <div class="format-buttons">
                            <button class="format-btn" data-format="pptx">
                                <i class="fas fa-file-powerpoint"></i> PowerPoint
                            </button>
                        </div>
                    </div>

                    <div class="format-group">
                        <h3>图片格式</h3>
                        <div class="format-buttons">
                            <button class="format-btn" data-format="jpg">
                                <i class="fas fa-file-image"></i> JPG
                            </button>
                            <button class="format-btn" data-format="png">
                                <i class="fas fa-file-image"></i> PNG
                            </button>
                            <button class="format-btn" data-format="gif">
                                <i class="fas fa-file-image"></i> GIF
                            </button>
                        </div>
                    </div>
                </div>

                <button class="convert-btn" id="convertBtn" disabled>
                    <i class="fas fa-exchange-alt"></i> 开始转换
                </button>
            </div>

            <!-- 进度显示 -->
            <div class="progress-section" id="progressSection" style="display: none;">
                <h2>转换进度</h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                    <span class="progress-text" id="progressText">0%</span>
                </div>
                <div class="status-message" id="statusMessage">准备转换...</div>
            </div>

            <!-- 下载区域 -->
            <div class="download-section" id="downloadSection" style="display: none;">
                <h2>转换完成</h2>
                <div class="download-card">
                    <i class="fas fa-check-circle success-icon"></i>
                    <h3>文件转换成功！</h3>
                    <p>您的文件已成功转换为 <strong id="targetFormat"></strong> 格式</p>
                    <button class="download-btn" id="downloadBtn">
                        <i class="fas fa-download"></i> 下载文件
                    </button>
                </div>
            </div>
        </main>

        <!-- 错误提示 -->
        <div class="error-modal" id="errorModal">
            <div class="error-content">
                <i class="fas fa-exclamation-triangle"></i>
                <h3>转换失败</h3>
                <p id="errorMessage">发生了一些错误，请重试</p>
                <button class="close-btn" onclick="closeErrorModal()">确定</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    <script src="script.js"></script>
</body>
</html>